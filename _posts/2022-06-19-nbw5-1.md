---
title:  "λ‚΄μΌλ°°μ›€λ‹¨ Web5.1"
categories: SpartaWeb
toc: true
toc_sticky: true
sidebar:
    nav: docs
---

# [μ›Ήκ°λ° μΆ…ν•©λ°] 5μ£Ό 1μΌμ°¨ κ°λ°μΌμ§€(5μ£Ό 1-8κ°•)

<br>

## π’»TIL Web.501

## 'λ¬΄λΉ„μ¤νƒ€' ν”„λ΅μ νΈ

## 1. DB λ§λ“¤κΈ°(λ°μ΄ν„° μ“κΈ°)

ν†µμƒμ μΌλ΅, λ°μ΄ν„°λ¥Ό λ¨Όμ € λ¨μ•„λ‘κ³  κ·Έ λ‹¤μμ— λ¨μ•„λ‘” λ°μ΄ν„°λ¥Ό λ³΄μ—¬μ¤€λ‹¤. μ΄λ² ν”„λ΅μ νΈμ—μ„ μ‚¬μ©λ  λ°μ΄ν„°λ”, ν¬λ΅¤λ§μ„ ν†µν•΄ μν™”μΈλ“¤μ μ΄λ¦„, ν”„λ΅ν•„, μµμ‹ μ‘ λ“±μ΄λ‹¤. `init_db.py` νμΌμ„ μƒμ„±ν• ν›„(νμΌλ…μ€ μƒκ΄€ μ—†μ) μ•„λ ν¬λ΅¤λ§ μ½”λ“λ¥Ό λ¶™μ—¬λ„£μ. νμΌμ„ μ‹¤ν–‰ν•λ©΄ μ¶λ ¥μ°½μ— λ°μ΄ν„°λ“¤μ΄ μ°¨λ΅€λ΅ ν¬λ΅¤λ§λλ©°, Robo 3Tμ—μ„ λ°μ΄ν„°λ“¤μ΄ μ μ“μΈ κ²ƒμ„ ν™•μΈν•  μ μλ‹¤. λ°μ΄ν„°κ°€ μ“μΈ κ²ƒμ„ ν™•μΈν• ν›„ `init_db` νμΌμ€ μ‚­μ ν•λ‹¤.

```py
import requests
from bs4 import BeautifulSoup

from pymongo import MongoClient

client = MongoClient('localhost', 27017)
db = client.dbsparta


# DBμ— μ €μ¥ν•  μν™”μΈλ“¤μ μ¶μ² urlμ„ κ°€μ Έμµλ‹λ‹¤.
def get_urls():
    headers = {
        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64)AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.86 Safari/537.36'}
    data = requests.get('https://movie.naver.com/movie/sdb/rank/rpeople.nhn', headers=headers)

    soup = BeautifulSoup(data.text, 'html.parser')

    trs = soup.select('#old_content > table > tbody > tr')

    urls = []
    for tr in trs:
        a = tr.select_one('td.title > a')
        if a is not None:
            base_url = 'https://movie.naver.com/'
            url = base_url + a['href']
            urls.append(url)

    return urls


# μ¶μ² urlλ΅λ¶€ν„° μν™”μΈλ“¤μ μ‚¬μ§„, μ΄λ¦„, μµκ·Όμ‘ μ •λ³΄λ¥Ό κ°€μ Έμ¤κ³  mystar μ½λ ‰μ…μ— μ €μ¥ν•©λ‹λ‹¤.
def insert_star(url):
    headers = {
        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64)AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.86 Safari/537.36'}
    data = requests.get(url, headers=headers)

    soup = BeautifulSoup(data.text, 'html.parser')

    name = soup.select_one('#content > div.article > div.mv_info_area > div.mv_info.character > h3 > a').text
    img_url = soup.select_one('#content > div.article > div.mv_info_area > div.poster > img')['src']
    recent_work = soup.select_one(
        '#content > div.article > div.mv_info_area > div.mv_info.character > dl > dd > a:nth-child(1)').text

    doc = {
        'name': name,
        'img_url': img_url,
        'recent': recent_work,
        'url': url,
        'like': 0
    }

    db.mystar.insert_one(doc)
    print('μ™„λ£!', name)


# κΈ°μ΅΄ mystar μ½λ ‰μ…μ„ μ‚­μ ν•κ³ , μ¶μ² urlλ“¤μ„ κ°€μ Έμ¨ ν›„, ν¬λ΅¤λ§ν•μ—¬ DBμ— μ €μ¥ν•©λ‹λ‹¤.
def insert_all():
    db.mystar.drop()  # mystar μ½λ ‰μ…μ„ λ¨λ‘ μ§€μ›μ¤λ‹λ‹¤.
    urls = get_urls()
    for url in urls:
        insert_star(url)


### μ‹¤ν–‰ν•κΈ°
insert_all()
```

<br>


## 2. λΌλ€ μ¤€λΉ„ν•κΈ°

μ•„λ μ½”λ“λ¥Ό κ°κ° `app.py`μ™€ `index.html`μ— λ¶™μ—¬λ„£μ.

```py
from pymongo import MongoClient

from flask import Flask, render_template, jsonify, request

app = Flask(__name__)

client = MongoClient('localhost', 27017)
db = client.dbsparta


# HTML ν™”λ©΄ λ³΄μ—¬μ£ΌκΈ°
@app.route('/')
def home():
    return render_template('index.html')


# API μ—­ν• μ„ ν•λ” λ¶€λ¶„
@app.route('/api/list', methods=['GET'])
def show_stars():
    sample_receive = request.args.get('sample_give')
    print(sample_receive)
    return jsonify({'msg': 'list μ—°κ²°λμ—μµλ‹λ‹¤!'})


@app.route('/api/like', methods=['POST'])
def like_star():
    sample_receive = request.form['sample_give']
    print(sample_receive)
    return jsonify({'msg': 'like μ—°κ²°λμ—μµλ‹λ‹¤!'})


@app.route('/api/delete', methods=['POST'])
def delete_star():
    sample_receive = request.form['sample_give']
    print(sample_receive)
    return jsonify({'msg': 'delete μ—°κ²°λμ—μµλ‹λ‹¤!'})


if __name__ == '__main__':
    app.run('0.0.0.0', port=5000, debug=True)
```
<br>

```html
<!DOCTYPE html>
<html lang="ko">
    <head>
        <meta charset="UTF-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <title>λ§μ΄ νμ΄λ³΄λ¦Ώ λ¬΄λΉ„μ¤νƒ€ | ν”„λ΅ νΈ-λ°±μ—”λ“ μ—°κ²° λ§μ§€λ§‰ μμ !</title>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.8.0/css/bulma.min.css"/>
        <script defer src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"></script>
        <style>
            .center {
                text-align: center;
            }

            .star-list {
                width: 500px;
                margin: 20px auto 0 auto;
            }

            .star-name {
                display: inline-block;
            }

            .star-name:hover {
                text-decoration: underline;
            }

            .card {
                margin-bottom: 15px;
            }
        </style>
        <script>
            $(document).ready(function () {
                showStar();
            });

            function showStar() {
                $.ajax({
                    type: 'GET',
                    url: '/api/list?sample_give=μƒν”λ°μ΄ν„°',
                    data: {},
                    success: function (response) {
                        alert(response['msg']);
                    }
                });
            }

            function likeStar(name) {
                $.ajax({
                    type: 'POST',
                    url: '/api/like',
                    data: {sample_give:'μƒν”λ°μ΄ν„°'},
                    success: function (response) {
                        alert(response['msg']);
                    }
                });
            }

            function deleteStar(name) {
                $.ajax({
                    type: 'POST',
                    url: '/api/delete',
                    data: {sample_give:'μƒν”λ°μ΄ν„°'},
                    success: function (response) {
                        alert(response['msg']);
                    }
                });
            }

        </script>
    </head>
    <body>
        <section class="hero is-warning">
            <div class="hero-body">
                <div class="container center">
                    <h1 class="title">
                        λ§μ΄ νμ΄λ³΄λ¦Ώ λ¬΄λΉ„μ¤νƒ€π†
                    </h1>
                    <h2 class="subtitle">
                        μμ„λ¥Ό λ§¤κ²¨λ΄…μ‹λ‹¤
                    </h2>
                </div>
            </div>
        </section>
        <div class="star-list" id="star-box">
            <div class="card">
                <div class="card-content">
                    <div class="media">
                        <div class="media-left">
                            <figure class="image is-48x48">
                                <img
                                        src="https://search.pstatic.net/common/?src=https%3A%2F%2Fssl.pstatic.net%2Fsstatic%2Fpeople%2Fportrait%2F201807%2F20180731143610623-6213324.jpg&type=u120_150&quality=95"
                                        alt="Placeholder image"
                                />
                            </figure>
                        </div>
                        <div class="media-content">
                            <a href="#" target="_blank" class="star-name title is-4">κΉ€λ‹¤λ―Έ (μΆ‹μ•„μ”: 3)</a>
                            <p class="subtitle is-6">μ•λ…•, λ‚μ μ†μΈλ©”μ΄νΈ(κ°€μ )</p>
                        </div>
                    </div>
                </div>
                <footer class="card-footer">
                    <a href="#" onclick="likeStar('κΉ€λ‹¤λ―Έ')" class="card-footer-item has-text-info">
                        μ„λ΅!
                        <span class="icon">
              <i class="fas fa-thumbs-up"></i>
            </span>
                    </a>
                    <a href="#" onclick="deleteStar('κΉ€λ‹¤λ―Έ')" class="card-footer-item has-text-danger">
                        μ‚­μ 
                        <span class="icon">
              <i class="fas fa-ban"></i>
            </span>
                    </a>
                </footer>
            </div>
        </div>
    </body>
</html>
```

<br>

## 3. λ©λ΅ λ³΄μ—¬μ£ΌκΈ°(GET)

### 1) ν΄λΌμ΄μ–ΈνΈ/μ„λ²„ μ—°κ²° ν™•μΈν•κΈ°

```py
@app.route('/api/list', methods=['GET'])
def show_stars():
  sample_receive = request.args.get('sample_give')
  print(sample_receive)
  return jsonify({'msg': 'list μ—°κ²°λμ—μµλ‹λ‹¤!'})
```

```html
<script>
  $(document).ready(function () {
    showStar();
  });

  function showStar() {
    $.ajax({
      type: 'GET',
      url: '/api/list?sample_give=μƒν”λ°μ΄ν„°',
      data: {},
      success: function (response) {
        alert(response['msg']);
      }
    });
  }
</script>
```

<br>

---

### 2) μ„λ²„ λ§λ“¤κΈ°


![web501 data](../../assets/images/w05_star01.jpg){: .align-center}

μ„λ²„μ—μ„λ”, ν΄λΌμ΄μ–ΈνΈμ—μ„ λ°μ΄ν„°λ¥Ό λ°›μ„ ν•„μ” μ—†μ΄, μ“μ•„λ‘” λ°μ΄ν„°λ“¤μ„ λ¦¬μ¤νΈ(array) ν•νƒλ΅ λ‚΄λ ¤μ£ΌκΈ°λ§ ν•λ©΄ λλ‹¤. λ‹¨, μ΄λ²μ—λ” `like` μ†μ„±κ°’μ μ—­μμΌλ΅(likeκ°€ ν° μμ„λ€λ΅) λ°μ΄ν„°λ¥Ό λ‚΄λ ¤μ¤μ•Ό ν•λ‹¤. 

<br>

```py
@app.route('/api/list', methods=['GET'])
def show_stars():
  movie_star = list(db.mystar.find({},{'_id':False}))
  return jsonify({'movie_stars': movie_star})
```
μΌλ‹¨ `movie_star`λΌλ” μƒλ΅μ΄ λ³€μμ— pymongoλ¥Ό μ΄μ©ν•΄ λ°μ΄ν„° λ¦¬μ¤νΈλ¥Ό λ‹΄κ³ , μ΄λ¥Ό ν΄λΌμ΄μ–ΈνΈμ— λ‚΄λ ¤μ¤€λ‹¤.

<br>

'pymongo μ •λ ¬', 'pymongo sort w3school'λ¥Ό [κµ¬κΈ€λ§][1]ν•΄λ³΄λ‹, `sort()`κ°€ μλ‹¤. μμ‹λ¥Ό λ³΄λ‹ `find().sort("name",-1)`κ³Ό κ°™μ΄ μ΄μ©ν•  μ μλ‹¤. μ²« parameterλ” fieldname, λ‹¤μ parameterλ” μ¤λ¦„μ°¨μ(ascending, 1)κ³Ό λ‚΄λ¦Όμ°¨μ(descending, -1)μ„ κ²°μ •ν•λ‹¤. κΈ°λ³Έκ°’μ€ μ¤λ¦„μ°¨μμ΄λ‹¤. μ•„λ μ½”λ“λ¥Ό μ‚¬μ©ν•΄ λ°μ΄ν„°λ¥Ό λ‚΄λ¦Όμ°¨μ μ •λ ¬μ‹ν‚¬ μ μλ‹¤. 

```py
@app.route('/api/list', methods=['GET'])
def show_stars():
  movie_star = list(db.mystar.find({},{'_id':False}).sort('like', -1))
  return jsonify({'movie_stars': movie_star})
```

<br>

---

### 3) ν΄λΌμ΄μ–ΈνΈ λ§λ“¤κΈ°

```js
function showStar() {
  $.ajax({
    type: 'GET',
    url: '/api/list',
    data: {},
    success: function (response) {
      let mystars = response['movie_stars'];
      console.log(mystars);
    }
  });
}
```
ν΄λΌμ΄μ–ΈνΈ(HTML νμΌ)μ—μ„λ”, λ¨Όμ € `console.log`λ¥Ό ν†µν•΄ μ„λ²„κ°€ λ‚΄λ ¤μ¤€ λ°μ΄ν„°κ°€ μ μ „λ‹¬λμ—λ”μ§€ ν™•μΈν•΄ λ³Έλ‹¤. νμ΄μ§€λ¥Ό μ‹¤ν–‰μ‹ν‚¤λ©΄ consoleμ°½μ— λ°μ΄ν„° λ¦¬μ¤νΈκ°€ λ¨λ” κ²ƒμ„ λ³Ό μ μλ‹¤.

<br>

λ°μ΄ν„° λ¦¬μ¤νΈκ°€ μ μ „λ‹¬λμ—λ‹¤λ©΄, for λ°λ³µλ¬Έμ„ μ‚¬μ©ν•΄ λ°μ΄ν„°λ¥Ό λλ ¤μ•Ό ν•λ‹¤. μ΄λ²μ—λ„ λ¨Όμ € `console.log`λ΅ λ°μ΄ν„° μ „λ‹¬μ„ ν™•μΈν•λ” λ‹¨κ³„λ¥Ό κ±°μΉλ‹¤.

```js
function showStar() {
  $.ajax({
    type: 'GET',
    url: '/api/list',
    data: {},
    success: function (response) {
      let mystars = response['movie_stars']

      for(let i=0; i < mystars.length; i++) {
        let img_url = mystars[i]['img_url']
        let name = mystars[i]['name']
        let recent = mystars[i]['recent']
        let url = mystars[i]['url']
        let like = mystars[i]['like']

        let temp_html =`<div class="card">
                            <div class="card-content">
                                <div class="media">
                                    <div class="media-left">
                                        <figure class="image is-48x48">
                                            <img
                                                src="${img_url}"
                                                alt="Placeholder image"
                                            />
                                        </figure>
                                    </div>
                                    <div class="media-content">
                                        <a href="${url}" target="_blank" class="star-name title is-4">${name} (μΆ‹μ•„μ”: ${like})</a>
                                        <p class="subtitle is-6">${recent}</p>
                                    </div>
                                </div>
                            </div>
                            <footer class="card-footer">
                                <a href="#" onclick="likeStar('${name}')" class="card-footer-item has-text-info">
                                    μ„λ΅!
                                    <span class="icon">
                          <i class="fas fa-thumbs-up"></i>
                        </span>
                                </a>
                                <a href="#" onclick="deleteStar('${name}')" class="card-footer-item has-text-danger">
                                    μ‚­μ 
                                    <span class="icon">
                          <i class="fas fa-ban"></i>
                        </span>
                                </a>
                            </footer>
                        </div>`

          $('#star-box').append(temp_html)
      }
    }
  })
}
```
μΉ΄λ“ ν•λ‚μ— ν•΄λ‹Ήν•λ” μ½”λ“λ¥Ό λ³µμ‚¬ν•΄ `temp_html` λ³€μμ— κ·Έλ€λ΅ λ¶™μ—¬λ„£κ³ , `img`, `name`, `recent`, `url` λ³€μλ“¤μ„ κ°κ° ν•„μ”ν• κ³³μ— `${}` ν•νƒλ΅ μ…λ ¥ν•λ‹¤. λ‹¤μμΌλ΅, μΉ΄λ“κ°€ λ¶™μ—¬μ§ μƒμ„ νƒκ·Έμ μ•„μ΄λ””λ¥Ό μ°Ύμ•„ `append`λ¥Ό μ‚¬μ©ν•λ‹¤. λ‚λ” μ²μμ— `like` λ³€μλ¥Ό μ •μν•λ” κ²ƒμ„ μμ—λ‹¤. μ„λ²„ μ½μ—μ„ `sort()`λ¥Ό μ‚¬μ©ν•  λ• `like`λΌλ” μƒλ΅μ΄ λ³€μλ¥Ό μ„¤μ •ν–μΌλ―€λ΅, `like` λ³€μλ” μ„λ²„ μ½μ `'movie-stars'`, μ¦‰ ν΄λΌμ΄μ–ΈνΈ μ½μ `response['movie_stars']`μ ν‚¤λ΅ μ΅΄μ¬ν•λ‹¤.

> μ‚¬μ©λλ” λ³€μκ°€ μ •μλμ§€ μ•μ•κ±°λ‚, λ³€μλ…μ— μ¤νƒ€κ°€ μμΌλ©΄ λ°μ΄ν„°κ°€ μ λ€λ΅ μ „λ‹¬λμ§€ μ•μ•„ ν™”λ©΄μ— μ•„λ¬΄κ²ƒλ„ λ¨μ§€ μ•λ”λ‹¤. μ¤νƒ€ λ°©μ§€λ¥Ό μ„ν•΄ λ³€μλ…μ€ λ³µμ‚¬ λ¶™μ—¬λ„£κΈ°λ¥Ό μ‚¬μ©ν•κ³ , μ‚¬μ©λ λ³€μκ°€ λ¨λ‘ μ μ •μλμ—λ”μ§€ ν™•μΈν•  κ²ƒ!

<br>

---

### 4) μ™„μ„± ν™•μΈν•κΈ°

<figure class="half">
  <a href="../../assets/images/w05_star02.jpg"><img src="../../assets/images/w05_star02.jpg"></a>
  <a href="../../assets/images/w05_star03.jpg"><img src="../../assets/images/w05_star03.jpg"></a>
</figure>

μ„ μ‚¬μ§„κ³Ό κ°™μ΄, μ…λ ¥ν• λ°μ΄ν„°κ°€ μΉ΄λ“ ν•νƒλ΅ νμ΄μ§€μ— μ¶”κ°€λμ—μμ„ ν™•μΈν•  μ μλ‹¤. `like`μ μ—­μμΌλ΅ μ΅°νλλ”μ§€ ν™•μΈν•κΈ° μ„ν•΄μ„, Robo 3Tμ 'mystar' λ°μ΄ν„°λ² μ΄μ¤μ—μ„ `like` μ†μ„± > 'Edit Document'λ¥Ό μ„ νƒν•΄ μ†μ„±κ°’μ„ λ°”κΏ”λ³Έλ‹¤. νμ΄μ§€λ¥Ό μƒλ΅κ³ μΉ¨ν•λ©΄ `like` μλ€λ΅ λ°μ΄ν„°κ°€ μ •λ ¬λμ—μμ„ ν™•μΈν•  μ μλ‹¤.

<br>

## 4. μΆ‹μ•„μ” κΈ°λ¥ κµ¬ν„ν•κΈ°(POST)

+ **API μ„¤κ³„**

ν΄λΌμ΄μ–ΈνΈ μ½μ—μ„λ” ν΄λ¦­λ μΉ΄λ“μ μ΄λ¦„μ„ μ„λ²„λ΅ μ „λ‹¬, μ„λ²„μ—μ„λ” ν΄λΌμ΄μ–ΈνΈμ—μ„ λ°›μ€ μ΄λ¦„μ„ μ°Ύμ•„μ„ `like`λ¥Ό 1 μ¦κ°€μ‹ν‚¨ ν›„ λ°μ΄ν„°λ² μ΄μ¤μ— μ—…λ°μ΄νΈν•λ‹¤. 


### 1) ν΄λΌμ΄μ–ΈνΈ/μ„λ²„ μ—°κ²° ν™•μΈν•κΈ°

```py
@app.route('/api/like', methods=['POST'])
def like_star():
  sample_receive = request.form['sample_give']
  print(sample_receive)
  return jsonify({'msg': 'like μ—°κ²°λμ—μµλ‹λ‹¤!'})
```

```html
<script>
  function likeStar(name) {
    $.ajax({
      type: 'POST',
      url: '/api/like',
      data: {sample_give: 'μƒν”λ°μ΄ν„°'},
      success: function (response) {
        alert(response['msg']);
      }
    });
  }
</script>

<body>
  <footer class="card-footer">
    <a href="#" onclick="likeStar('${name}')" class="card-footer-item has-text-info">
    μ„λ΅!
    <span class="icon">
      <i class="fas fa-thumbs-up"></i>
    </span>
    </a>
    ...
  </footer>
</body>
```
μΆ‹μ•„μ” κΈ°λ¥μ€ `like` λ³€μλ¥Ό μ—…λ°μ΄νΈν•λ” μΌμ΄λ―€λ΅ POST μ”μ²­μ„ μ΄μ©ν•λ‹¤. μ„λ²„μ—μ„λ” ν΄λΌμ΄μ–ΈνΈ μ½μ—μ„ `sample_give`λ΅ λ°μ΄ν„°λ¥Ό λ°›μ•„ `sample_receive`μ— μ €μ¥, μ΄λ¥Ό μ¶λ ¥ν• ν›„ `msg`λ¥Ό λ‚΄λ ¤μ¤€λ‹¤. ν΄λΌμ΄μ–ΈνΈμ—μ„λ” `name`μ„ μΈμλ΅ λ°›λ” `likeStar` ν•¨μκ°€ μμΌλ©°, ν•¨μλ” μΉ΄λ“ μ•„λμ½ 'μ„λ΅!'  λ¶€λ¶„μ„ ν΄λ¦­ν•λ©΄ νΈμ¶λλ‹¤. ν•¨μκ°€ νΈμ¶λλ©΄ `sample_give` λ³€μλ΅ λ°μ΄ν„°λ¥Ό μ„λ²„λ΅ μ „λ‹¬ν•κ³ , μ„λ²„λ΅λ¶€ν„° μ¨ `msg`λ¥Ό alertμ°½μ— λ„μ΄λ‹¤.  'μ„λ΅!'λ¥Ό ν΄λ¦­ν•λ©΄ alert μ°½μ΄ λ¨λ” κ²ƒμΌλ΅ μ—°κ²°μ„ ν™•μΈν•  μ μλ‹¤.

<br>

---

### 2) μ„λ²„ λ§λ“¤κΈ°

```py
@app.route('/api/like', methods=['POST'])
def like_star():
  name_receive = request.form['name_give']

  target_star = db.mystar.find_one({'name': name_receive})
  current_like = target_star['like']
  new_like = current_like + 1

  db.mystar.update_one({'name': name_receive},{'$set':{'like': new_like}})

  return jsonify({'msg': 'μΆ‹μ•„μ” μ™„λ£!'})
```

μ„λ²„μ—μ„λ” λ¨Όμ €, ν΄λΌμ΄μ–ΈνΈμ—μ„ μ΄λ¦„μ„ λ°›μ•„ ν•΄λ‹Ή μ΄λ¦„μ `like`λ¥Ό μ°Ύμ•„μ•Ό ν•λ‹¤. μ°Ύμ€ λ°μ΄ν„°μ `like` λ³€μλ¥Ό λ¶λ¬μ¨ λ‹¤μ, ν•λ‚λ¥Ό λ”ν•΄μ•Ό ν•λ―€λ΅ μ›λ λ³€μμ— 1μ„ λ”ν• μƒλ΅μ΄ λ³€μλ¥Ό μ§€μ •ν•λ‹¤. λ‹¨μν μƒλ΅μ΄ `like` κ°’μ„ μ¶λ ¥ν•κ±°λ‚ λ‚΄λ ¤μ£Όλ” κ²ƒμ΄ μ•„λ‹λΌ, μ„λ²„μ— μ—…λ°μ΄νΈκΉμ§€ ν•΄μ•Ό ν•λ―€λ΅ `update()`λ¥Ό μ΄μ©ν•λ‹¤.

<br>

---

### 3) ν΄λΌμ΄μ–ΈνΈ λ§λ“¤κΈ°

```js
function likeStar(name) {
  $.ajax({
    type: 'POST',
    url: '/api/like',
    data: {name_give: name},
    success: function (response) {
      alert(response['msg']);
      window.location.reload();
    }
  });
}
```
<br>

---

### 4) μ™„μ„± ν™•μΈν•κΈ°

<figure class="half">
  <a href="../../assets/images/w05_star04.jpg"><img src="../../assets/images/w05_star04.jpg"></a>
  <a href="../../assets/images/w05_star05.jpg"><img src="../../assets/images/w05_star05.jpg"></a>
</figure>

'μ„λ΅!' λ²„νΌμ„ λ„λ¥΄λ©΄ 'μΆ‹μ•„μ” μ™„λ£!' alert μ°½μ΄ λ¨κ³ , μƒλ΅κ³ μΉ¨λ νμ΄μ§€μ— μ—…λ°μ΄νΈλ `like`μ— λ”°λΌ λ°μ΄ν„°κ°€ μ •λ ¬λ¨μ„ ν™•μΈν•  μ μλ‹¤.

<br>

## 5. μ‚­μ  κΈ°λ¥ κµ¬ν„ν•κΈ°(POST)

+ **API μ„¤κ³„**

ν΄λΌμ΄μ–ΈνΈ μ½μ—μ„λ” ν΄λ¦­λ μΉ΄λ“μ μ΄λ¦„μ„ μ„λ²„λ΅ μ „λ‹¬, μ„λ²„μ—μ„λ” ν΄λΌμ΄μ–ΈνΈμ—μ„ λ°›μ€ μ΄λ¦„μ„ μ°Ύμ•„μ„ ν•΄λ‹Ή μ΄λ¦„μ λ°μ΄ν„°λ¥Ό μ‚­μ ν•λ‹¤. 

### 1) ν΄λΌμ΄μ–ΈνΈ/μ„λ²„ μ—°κ²° ν™•μΈν•κΈ°

```py
@app.route('/api/delete', methods=['POST'])
def delete_star():
  sample_receive = request.form['sample_give']
  print(sample_receive)
  return jsonify({'msg': 'delete μ—°κ²°λμ—μµλ‹λ‹¤!'})
```

```html
<script>
  function deleteStar(name) {
    $.ajax({
      type: 'POST',
      url: '/api/delete',
      data: {sample_give:'μƒν”λ°μ΄ν„°'},
      success: function (response) {
        alert(response['msg']);
      }
    });
  }
</script>

<body>
  ...
    <a href="#" onclick="deleteStar('${name}')" class="card-footer-item has-text-danger">
        μ‚­μ 
    <span class="icon">
      <i class="fas fa-ban"></i>
    </span>
    </a>
  </footer>
</body>
```
μ„λ²„ APIλ” '/api/delete' URLλ΅ POST μ”μ²­μ„ λ°›κ³  , ν΄λΌμ΄μ–ΈνΈλ” `data`λ΅ μ„λ²„μ— λ°μ΄ν„°λ¥Ό κ°–κ³  κ°„λ‹¤. `deleteStar` ν•¨μλ” 'μ‚­μ ' λ²„νΌμ΄ ν΄λ¦­λμ—μ„ λ• νΈμ¶λλ‹¤. 'μ‚­μ ' λ²„νΌμ„ λ„λ¥΄λ©΄ 'delete μ—°κ²°λμ—μµλ‹λ‹¤!' alert μ°½μ΄ λ¨λ―€λ΅ μ—°κ²°μ„ ν™•μΈν•  μ μλ‹¤.

<br>

---

### 2) μ„λ²„ λ§λ“¤κΈ°

```py
@app.route('/api/delete', methods=['POST'])
def delete_star():
  name_receive = request.form['name_give']
  db.mystar.delete_one({'name': name_receive})

  return jsonify({'msg': 'μ‚­μ  μ™„λ£!'})
```
API μ„¤κ³„μ—μ„ μ–ΈκΈ‰ν–λ“―, μ„λ²„λ” ν΄λΌμ΄μ–ΈνΈμ—μ„ λ°›μ€ μ΄λ¦„μ— ν•΄λ‹Ήν•λ” λ°μ΄ν„°λ¥Ό μ°Ύμ•„ μ‚­μ ν•λ‹¤. μ‚­μ  κΈ°λ¥μ κ²½μ°, μ΄λ¦„μ— ν•΄λ‹Ήν•λ” λ°μ΄ν„°μ μ†μ„±μ„ μ‚¬μ©ν•μ§€ μ•μΌλ―€λ΅ λ³€μ μ„¤μ • μ—†μ΄ μ°Ύμ€ μ΄λ¦„μ„ κ·Έλ€λ΅ μ΄μ©ν•λ‹¤.

<br>

---

### 3) ν΄λΌμ΄μ–ΈνΈ λ§λ“¤κΈ°

```js
function deleteStar(name) {
  $.ajax({
    type: 'POST',
    url: '/api/delete',
    data: {name_give: name},
    success: function (response) {
      alert(response['msg']);
      window.location.reload();
    }
  });
}
```

<br>

---

### 4) μ™„μ„± ν™•μΈν•κΈ°

<figure class="half">
  <a href="../../assets/images/w05_star06.jpg"><img src="../../assets/images/w05_star06.jpg"></a>
  <a href="../../assets/images/w05_star07.jpg"><img src="../../assets/images/w05_star07.jpg"></a>
</figure>

'μ‚­μ ' λ²„νΌμ„ λ„λ¥΄λ©΄ `msg`κ°€ alert μ°½μΌλ΅ λ¨κ³ , μƒλ΅κ³ μΉ¨λ νμ΄μ§€μ—μ„ ν•΄λ‹Ή λ°μ΄ν„°κ°€ μ‚¬λΌμ§„ κ²ƒμ„ ν™•μΈν•  μ μλ‹¤.


<br>

[1]: https://www.w3schools.com/python/python_mongodb_sort.asp