---
title:  "내일배움단 Web2.2"
categories: SpartaCoding
tags: [내일배움단, 웹개발, 2주차]
sidebar:
    nav: docs
---

# [웹개발 종합반] 2주 2일차 개발일지(2주 7-11강)

<br>

## 💻TIL Web.202

## 1. 서버-클라이언트 통신 이해하기

### 1) JSON

**Ajax**는 자바스크립트를 이용해 페이지 전환 없이 서버에서 값을 받아올 수 있는 방법이다. 클라이언트는 서버에게 데이터를 요청하는데, 이때 서버가 클라이언트에게 요청을 받는 창구를  **API**라고 한다. 서버가 클라이언트에게 요청을 받은 후 데이터를 내려줄 때의 포맷이 있는데, 이 포맷을 **JSON**이라고 한다. JSON은 Array(리스트)와 Object(딕셔너리)의 조합과 그 생김새가 같다. 실제 값을 이용할 때는 이러한 구조를 타고 타고 들어가서 값에 접근한다.

<br>

### 2) 클라이언트->서버: GET 요청

앞에 정의된 대로 API는 서버가 클라이언트에게 데이터 요청을 받는 창구라 할 수 있다. 클라이언트는 GET과 POST를 포함한 여러 타입으로 데이터를 요청할 수 있다. 통상적으로 **GET**은 데이터 조회(read)를 할 때, **POST**는 데이터 생성(create), 변경(Update), 삭제(delete) 요청을 할 때 사용된다. 예를 들어, 조건에 맞는 영화를 조회할 때는 GET, 회원가입과 탈퇴, 수정 등은 POST를 이용한다. 
<br>

+ GET이 url을 요청할 때

우리가 브라우저에 무언가를 입력하고 엔터를 치는 행위도 GET 요청에 해당한다. 아래의 url 주소를 간단히 살펴보자.

```html
https://movie.naver.com/movie/bi/mi/basic.naver?code=187320

<!--
  movie.naver.com => 서버의 주소 ex)우리은행 용산지점
  /movie/bi/mi/basic.naver => API의 주소 ex)우리은행 용산지점 안에서의 창구 이름(입출금 창구)
  code=187320 => 고객이 가지고 가는 데이터 ex)주민등록증...
-->
```
주소에서 `?`를 기준으로 앞쪽이 서버 주소, 뒤쪽이 고객이 가져가는 정보다. 위 예시에서는 고객이 `code`라는 값을 가져가는데, 이 값은 프론트엔드와 백엔드 개발자가 합의해 정한 이름이다. 이 이름이 같아야 데이터가 제대로 전달될 수 있다. 한편 `?` 뒤에 `&` 표시로 고객이 가져가는 정보를 덧붙일 수 있는데, 기존 주소에서 어떤 값을 덧붙여도 제대로 작동은 한다. 이는 꼭 필요한 정보만 사용하고 불필요한 정보는 사용하지 않기 때문이다.

<br>

## 2. Ajax

⚠️ Ajax는 jQuery를 import한 페이지에서만 작동한다. 다른 페이지의 개발자 도구 Console창에서는 Ajax 입력 시 에러가 뜬다.
<br>

### 1) Ajax 시작하기

+ **Ajax 기본 골격**

```js
$.ajax({
  type: "GET",
  url: "여기에URL을입력",
  data: {},
  success: function (response) {
    console.log(response);
  }
})
```
Ajax를 사용할 때는 위 코드를 그대로 가져다 복사해 쓰면 된다. `type`는 앞에서 배운 GET과 POST 등의 타입이며, `url`은 API 주소에 해당한다고 볼 수 있다. `data`는 요청하면서 함께 줄 데이터인데, 주로 POST에서 사용하므로 GET 요청 시에는 비워둔다. function의 parameter인 `response`(변수명은 바뀔 수 있음)에는 서버에서 준 결과가 자동으로 담긴다. 예를 들어, [미세먼지 Open API 주소][1]를 `url`에 입력하면 Ajax를 통해 관련 데이터에 접근하고 값을 처리할 수 있다.

<br>

### 2) Ajax 연습하기

① [서울시 OpenAPI][1]의 모든 구 이름과 미세먼지 수치 표기하기

② 업데이트 버튼을 누를 때마다 지웠다 새로 쓰여지게 하기

③ 미세먼지 수치가 70 이상인 곳은 빨간색으로 표시하기

+ **스스로 해보기**

```html
<script>
  function q1() {
    $.ajax({
      type: "GET",
      url: "http://openapi.seoul.go.kr:8088/6d4d776b466c656533356a4b4b5872/json/RealtimeCityAir/1/99",
      data: {},
      success: function (response) {
        let rows = response.RealtimeCityAir.row;
        for (let i = 0; i < rows.length; i++) {
          $('#names-q1').empty();
          let gu_name = rows[i].MSRSTE_NM;
          let gu_mise = rows[i].IDEX_MVL;

          let temp_html = `<li>${gu_name} : ${gu_mise}</li>`

          if (gu_mise > 70) {
            $('#names-q1').css('color', 'red');
          }
          $('#names-q1').append(temp_html);
        }
      }
    })
  }
</script>

<body>
  <button onclick="q1()">업데이트</button>
  <ul id="names-q1">
  </ul>
</body>
```
반복문을 사용해 JSON 데이터를 한 element씩 돌면서 해당 값을 찾고, `temp_html`과 `append`를 이용해 값을 출력했다. 여기까지만 하면 업데이트 버튼을 누를 때마다 새로운 값이 덧붙여서 기록되기 때문에 `empty`를 함수 처음에 사용해, 입력된 목록을 지우고 다시 입력될 수 있도록 했다. 미세먼지 수치가 70 이상인 곳을 빨간색으로 나타나게 하기 위해, 조건문과 `css('color', 'red')`로 css 속성값을 바꿔주었다.
<br>

❓완성 페이지와 달리 잠깐 지워지고 새로고침되지 않고, 업데이트 버튼을 눌러도 글자가 그대로 있다.

❓jQuery를 사용하면 `$('#아이디')` 형태로 아이디가 들어가야 하는데, 변수만 따로 속성값을 주는 방법을 모르겠다. 위의 코드를 실행시키면, 미세먼지가 70을 넘는 구가 하나라도 있으면 모든 목록의 색깔이 변한다.
<br>

---

+ **해설 코드**

```html
<script>
  function q1() {
    $('#names-q1').empty();
    $.ajax({
      type: "GET",
      url: "http://openapi.seoul.go.kr:8088/6d4d776b466c656533356a4b4b5872/json/RealtimeCityAir/1/99",
      data: {},
      success: function (response) {
        let rows = response["RealtimeCityAir"]["row"];
        for (let i = 0; i < rows.length; i++) {
          let gu_name = rows[i]['MSRSTE_NM'];
          let gu_mise = rows[i]['IDEX_MVL'];
          let temp_html = `<li>${gu_name} : ${gu_mise}</li>`
          $('#names-q1').append(temp_html);
        }
      }
    })
  }
</script>

<body>
  <button onclick="q1()">업데이트</button>
  <ul id="names-q1">
  </ul>
</body>
```
❗해설 코드를 보니, 글자가 그대로였던 이유는 내가 `empty()`를 `for`문 안에 써서였다. 함수의 가장 처음에 `empty()`를 써야 전체 입력값이 새롭게 나타날 수 있다.

❗


[1]: http://openapi.seoul.go.kr:8088/6d4d776b466c656533356a4b4b5872/json/RealtimeCityAir/1/99